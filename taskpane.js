!function(){var e={60947:function(e,t,a){"use strict";e.exports=a.p+"4c1b8a056627fbdae373.js"}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,a),r.exports}a.m=e,a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;a.g.importScripts&&(e=a.g.location+"");var t=a.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=n[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),a.p=e}(),a.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(e,t){var a=document.getElementById("status");a.textContent=e,a.className=t?"status error":"status success",setTimeout(function(){a.className="status"},5e3)}function t(){Excel.run(function(t){var a=document.getElementById("startDate").value,o=parseInt(document.getElementById("numPeriods").value)||36,r=t.workbook.worksheets;return r.load("items/name"),t.sync().then(function(){for(var e=0;e<r.items.length;e++)if("Capex"===r.items[e].name){r.items[e].delete();break}var g=r.add("Capex"),s=n(7+o-1);for(g.getRange("A1").values=[["Capex and D&A Calculator"]],g.getRange("A1").format.font.bold=!0,g.getRange("A1").format.font.size=16,g.getRange("A1").format.font.color="#217346",g.getRange("G3").values=[["Start date"]],g.getRange("G3").format.font.bold=!0,g.getRange("H3").values=[[a]],g.getRange("H3").numberFormat=[["yyyy-mm-dd"]],e=1;e<o;e++){var l=n(7+e),m=n(6+e);g.getRange(l+"3").formulas=[["=EDATE("+m+"3,1)"]],g.getRange(l+"3").numberFormat=[["yyyy-mm-dd"]]}for(g.getRange("G4").values=[["End date"]],g.getRange("G4").format.font.bold=!0,e=0;e<o;e++)l=n(7+e),g.getRange(l+"4").formulas=[["=EOMONTH("+l+"3,0)"]],g.getRange(l+"4").numberFormat=[["yyyy-mm-dd"]];for(g.getRange("G5").values=[["Period"]],g.getRange("G5").format.font.bold=!0,e=0;e<o;e++)l=n(7+e),g.getRange(l+"5").values=[[e+1]],g.getRange(l+"5").format.horizontalAlignment="Center";g.getRange("A6").values=[["Total D&A"]],g.getRange("A6").format.font.bold=!0,g.getRange("A6:G6").format.fill.color="#FFF2CC";for(var u=0;u<o;u++)l=n(7+u),g.getRange(l+"6").formulas=[["=SUM("+l+"9:"+l+"50)"]],g.getRange(l+"6").numberFormat=[["#,##0.00"]],g.getRange(l+"6").format.font.bold=!0,g.getRange(l+"6").format.fill.color="#FFF2CC";for(g.getRange("A7").values=[["Capex Total"]],g.getRange("A7").format.font.bold=!0,g.getRange("A7:G7").format.fill.color="#DDEBF7",u=0;u<o;u++)l=n(7+u),g.getRange(l+"7").formulas=[["=SUMIF($C$9:$C$50,"+l+"4,$E$9:$E$50)"]],g.getRange(l+"7").numberFormat=[["#,##0.00"]],g.getRange(l+"7").format.font.bold=!0,g.getRange(l+"7").format.fill.color="#DDEBF7";var f=g.getRange("A8:G8");for(f.values=[["Assets","Date","End period","Period","Cost","Useful Life","Salvage"]],f.format.font.bold=!0,f.format.fill.color="#217346",f.format.font.color="#FFFFFF",u=0;u<o;u++)l=n(7+u),g.getRange(l+"8").format.fill.color="#217346";for(var c=9;c<=50;c++)for(g.getRange("C"+c).formulas=[["=IF(B"+c+'="","-",EOMONTH(B'+c+",0))"]],g.getRange("C"+c).numberFormat=[["yyyy-mm-dd"]],g.getRange("D"+c).formulas=[["=IF(C"+c+'="-",0,MATCH(C'+c+",$H$4:$"+s+"$4,0))"]],u=0;u<o;u++){l=n(7+u);var i="=IF(OR($A"+c+'="",$D'+c+"=0),0,IF(AND("+(u+1)+">=$D"+c+","+(u+1)+"<$D"+c+"+$F"+c+"),($E"+c+"-$G"+c+")/$F"+c+",0))";g.getRange(l+c).formulas=[[i]],g.getRange(l+c).numberFormat=[["#,##0.00"]]}for(g.getRange("B9:B50").numberFormat=[["yyyy-mm-dd"]],g.getRange("E9:E50").numberFormat=[["#,##0.00"]],g.getRange("G9:G50").numberFormat=[["#,##0.00"]],g.getRange("A:G").format.autofitColumns(),u=0;u<o;u++)l=n(7+u),g.getRange(l+"1").format.columnWidth=75;for(g.freezePanes.freezeRows(8),g.freezePanes.freezeColumns(7),g.getRange("A8:"+s+"8").format.borders.getItem("EdgeBottom").style="Continuous",c=10;c<=50;c+=2)g.getRange("A"+c+":"+s+c).format.fill.color="#F9F9F9";return g.activate(),t.sync()}).then(function(){e("Template created with "+o+" periods and 42 asset rows!",!1)})}).catch(function(t){e("Error: "+t.message,!0),console.error(t)})}function a(){Excel.run(function(t){var a=document.getElementById("assetName").value,n=document.getElementById("assetDate").value,o=document.getElementById("assetCost").value,r=document.getElementById("usefulLife").value,g=document.getElementById("salvageValue").value||"0";if(!a||!o)return e("Please fill in asset name and cost",!0),t.sync();var s=t.workbook.worksheets.getItem("Capex"),l=s.getRange("A9:A50");return l.load("values"),t.sync().then(function(){for(var m=-1,u=0;u<l.values.length;u++)if(!l.values[u][0]){m=9+u;break}return-1===m?(e("No empty rows available (max 42 assets)",!0),t.sync()):(s.getRange("A"+m).values=[[a]],s.getRange("B"+m).values=[[n]],s.getRange("B"+m).numberFormat=[["yyyy-mm-dd"]],s.getRange("E"+m).values=[[parseFloat(o)]],s.getRange("E"+m).numberFormat=[["#,##0.00"]],s.getRange("F"+m).values=[[parseInt(r)]],s.getRange("G"+m).values=[[parseFloat(g)]],s.getRange("G"+m).numberFormat=[["#,##0.00"]],t.sync())}).then(function(){document.getElementById("assetName").value="",document.getElementById("assetCost").value="",e("Asset '"+a+"' added!",!1)})}).catch(function(t){e("Error: "+t.message,!0),console.error(t)})}function n(e){var t="";for(e+=1;e>0;){var a=(e-1)%26;t=String.fromCharCode(65+a)+t,e=Math.floor((e-1)/26)}return t}Office.onReady(function(e){e.host===Office.HostType.Excel&&(document.getElementById("createTemplate").onclick=t,document.getElementById("addAsset").onclick=a)})}(),function(){"use strict";new URL(a(60947),a.b)}()}();
//# sourceMappingURL=taskpane.js.map