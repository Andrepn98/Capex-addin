{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = (typeof document !== 'undefined' && document.baseURI) || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","Office.onReady(function(info) {\n  if (info.host === Office.HostType.Excel) {\n    document.getElementById(\"createTemplate\").onclick = createTemplate;\n    document.getElementById(\"addAsset\").onclick = addAsset;\n  }\n});\n\nfunction showStatus(message, isError) {\n  var status = document.getElementById(\"status\");\n  status.textContent = message;\n  status.className = isError ? \"status error\" : \"status success\";\n  setTimeout(function() { status.className = \"status\"; }, 5000);\n}\n\nfunction createTemplate() {\n  Excel.run(function(context) {\n    var startDateInput = document.getElementById(\"startDate\").value;\n    var numPeriods = parseInt(document.getElementById(\"numPeriods\").value) || 36;\n    \n    var sheets = context.workbook.worksheets;\n    sheets.load(\"items/name\");\n    \n    return context.sync().then(function() {\n      // Delete existing Capex sheet if exists\n      for (var i = 0; i < sheets.items.length; i++) {\n        if (sheets.items[i].name === \"Capex\") {\n          sheets.items[i].delete();\n          break;\n        }\n      }\n      \n      var sheet = sheets.add(\"Capex\");\n      var lastCol = getColumnLetter(7 + numPeriods - 1);\n      var lastAssetRow = 50; // Rows 9-50 for assets (42 slots)\n      \n      // === ROW 1: Title ===\n      sheet.getRange(\"A1\").values = [[\"Capex and D&A Calculator\"]];\n      sheet.getRange(\"A1\").format.font.bold = true;\n      sheet.getRange(\"A1\").format.font.size = 16;\n      sheet.getRange(\"A1\").format.font.color = \"#217346\";\n      \n      // === ROW 3: Start date row ===\n      sheet.getRange(\"G3\").values = [[\"Start date\"]];\n      sheet.getRange(\"G3\").format.font.bold = true;\n      sheet.getRange(\"H3\").values = [[startDateInput]];\n      sheet.getRange(\"H3\").numberFormat = [[\"yyyy-mm-dd\"]];\n      \n      for (var i = 1; i < numPeriods; i++) {\n        var col = getColumnLetter(7 + i);\n        var prevCol = getColumnLetter(6 + i);\n        sheet.getRange(col + \"3\").formulas = [[\"=EDATE(\" + prevCol + \"3,1)\"]];\n        sheet.getRange(col + \"3\").numberFormat = [[\"yyyy-mm-dd\"]];\n      }\n      \n      // === ROW 4: End date row ===\n      sheet.getRange(\"G4\").values = [[\"End date\"]];\n      sheet.getRange(\"G4\").format.font.bold = true;\n      for (var i = 0; i < numPeriods; i++) {\n        var col = getColumnLetter(7 + i);\n        sheet.getRange(col + \"4\").formulas = [[\"=EOMONTH(\" + col + \"3,0)\"]];\n        sheet.getRange(col + \"4\").numberFormat = [[\"yyyy-mm-dd\"]];\n      }\n      \n      // === ROW 5: Period numbers ===\n      sheet.getRange(\"G5\").values = [[\"Period\"]];\n      sheet.getRange(\"G5\").format.font.bold = true;\n      for (var i = 0; i < numPeriods; i++) {\n        var col = getColumnLetter(7 + i);\n        sheet.getRange(col + \"5\").values = [[i + 1]];\n        sheet.getRange(col + \"5\").format.horizontalAlignment = \"Center\";\n      }\n      \n      // === ROW 6: Total D&A (at top for visibility) ===\n      sheet.getRange(\"A6\").values = [[\"Total D&A\"]];\n      sheet.getRange(\"A6\").format.font.bold = true;\n      sheet.getRange(\"A6:G6\").format.fill.color = \"#FFF2CC\";\n      \n      for (var p = 0; p < numPeriods; p++) {\n        var col = getColumnLetter(7 + p);\n        sheet.getRange(col + \"6\").formulas = [[\"=SUM(\" + col + \"9:\" + col + lastAssetRow + \")\"]];\n        sheet.getRange(col + \"6\").numberFormat = [[\"#,##0.00\"]];\n        sheet.getRange(col + \"6\").format.font.bold = true;\n        sheet.getRange(col + \"6\").format.fill.color = \"#FFF2CC\";\n      }\n      \n      // === ROW 7: Capex Total (at top for visibility) ===\n      sheet.getRange(\"A7\").values = [[\"Capex Total\"]];\n      sheet.getRange(\"A7\").format.font.bold = true;\n      sheet.getRange(\"A7:G7\").format.fill.color = \"#DDEBF7\";\n      \n      for (var p = 0; p < numPeriods; p++) {\n        var col = getColumnLetter(7 + p);\n        sheet.getRange(col + \"7\").formulas = [[\"=SUMIF($C$9:$C$\" + lastAssetRow + \",\" + col + \"4,$E$9:$E$\" + lastAssetRow + \")\"]];\n        sheet.getRange(col + \"7\").numberFormat = [[\"#,##0.00\"]];\n        sheet.getRange(col + \"7\").format.font.bold = true;\n        sheet.getRange(col + \"7\").format.fill.color = \"#DDEBF7\";\n      }\n      \n      // === ROW 8: Column Headers ===\n      var headers = sheet.getRange(\"A8:G8\");\n      headers.values = [[\"Assets\", \"Date\", \"End period\", \"Period\", \"Cost\", \"Useful Life\", \"Salvage\"]];\n      headers.format.font.bold = true;\n      headers.format.fill.color = \"#217346\";\n      headers.format.font.color = \"#FFFFFF\";\n      \n      // Extend green header across period columns\n      for (var p = 0; p < numPeriods; p++) {\n        var col = getColumnLetter(7 + p);\n        sheet.getRange(col + \"8\").format.fill.color = \"#217346\";\n      }\n      \n      // === ROWS 9-50: Asset rows with formulas ===\n      for (var row = 9; row <= lastAssetRow; row++) {\n        // Column C: End period formula\n        sheet.getRange(\"C\" + row).formulas = [['=IF(B' + row + '=\"\",\"-\",EOMONTH(B' + row + ',0))']];\n        sheet.getRange(\"C\" + row).numberFormat = [[\"yyyy-mm-dd\"]];\n        \n        // Column D: Period lookup\n        sheet.getRange(\"D\" + row).formulas = [['=IF(C' + row + '=\"-\",0,MATCH(C' + row + ',$H$4:$' + lastCol + '$4,0))']];\n        \n        // D&A formulas for each period\n        for (var p = 0; p < numPeriods; p++) {\n          var col = getColumnLetter(7 + p);\n          var formula = '=IF(OR($A' + row + '=\"\",$D' + row + '=0),0,IF(AND(' + (p+1) + '>=$D' + row + ',' + (p+1) + '<$D' + row + '+$F' + row + '),($E' + row + '-$G' + row + ')/$F' + row + ',0))';\n          sheet.getRange(col + row).formulas = [[formula]];\n          sheet.getRange(col + row).numberFormat = [[\"#,##0.00\"]];\n        }\n      }\n      \n      // === Formatting ===\n      // Format date column B for asset rows\n      sheet.getRange(\"B9:B\" + lastAssetRow).numberFormat = [[\"yyyy-mm-dd\"]];\n      \n      // Format cost column E\n      sheet.getRange(\"E9:E\" + lastAssetRow).numberFormat = [[\"#,##0.00\"]];\n      \n      // Format salvage column G\n      sheet.getRange(\"G9:G\" + lastAssetRow).numberFormat = [[\"#,##0.00\"]];\n      \n      // Auto-fit columns A-G\n      sheet.getRange(\"A:G\").format.autofitColumns();\n      \n      // Set minimum width for period columns\n      for (var p = 0; p < numPeriods; p++) {\n        var col = getColumnLetter(7 + p);\n        sheet.getRange(col + \"1\").format.columnWidth = 75;\n      }\n      \n      // Freeze panes so headers stay visible\n      sheet.freezePanes.freezeRows(8);\n      sheet.freezePanes.freezeColumns(7);\n      \n      // Add borders to header row\n      sheet.getRange(\"A8:\" + lastCol + \"8\").format.borders.getItem(\"EdgeBottom\").style = \"Continuous\";\n      \n      // Alternate row colors for readability (light gray for even rows)\n      for (var row = 10; row <= lastAssetRow; row += 2) {\n        sheet.getRange(\"A\" + row + \":\" + lastCol + row).format.fill.color = \"#F9F9F9\";\n      }\n      \n      sheet.activate();\n      return context.sync();\n    }).then(function() {\n      showStatus(\"Template created with \" + numPeriods + \" periods and 42 asset rows!\", false);\n    });\n  }).catch(function(error) {\n    showStatus(\"Error: \" + error.message, true);\n    console.error(error);\n  });\n}\n\nfunction addAsset() {\n  Excel.run(function(context) {\n    var assetName = document.getElementById(\"assetName\").value;\n    var assetDate = document.getElementById(\"assetDate\").value;\n    var assetCost = document.getElementById(\"assetCost\").value;\n    var usefulLife = document.getElementById(\"usefulLife\").value;\n    var salvageValue = document.getElementById(\"salvageValue\").value || \"0\";\n    \n    if (!assetName || !assetCost) {\n      showStatus(\"Please fill in asset name and cost\", true);\n      return context.sync();\n    }\n    \n    var sheet = context.workbook.worksheets.getItem(\"Capex\");\n    var searchRange = sheet.getRange(\"A9:A50\"); // New range: rows 9-50\n    searchRange.load(\"values\");\n    \n    return context.sync().then(function() {\n      var targetRow = -1;\n      for (var i = 0; i < searchRange.values.length; i++) {\n        if (!searchRange.values[i][0]) {\n          targetRow = 9 + i; // Starts at row 9 now\n          break;\n        }\n      }\n      \n      if (targetRow === -1) {\n        showStatus(\"No empty rows available (max 42 assets)\", true);\n        return context.sync();\n      }\n      \n      sheet.getRange(\"A\" + targetRow).values = [[assetName]];\n      sheet.getRange(\"B\" + targetRow).values = [[assetDate]];\n      sheet.getRange(\"B\" + targetRow).numberFormat = [[\"yyyy-mm-dd\"]];\n      sheet.getRange(\"E\" + targetRow).values = [[parseFloat(assetCost)]];\n      sheet.getRange(\"E\" + targetRow).numberFormat = [[\"#,##0.00\"]];\n      sheet.getRange(\"F\" + targetRow).values = [[parseInt(usefulLife)]];\n      sheet.getRange(\"G\" + targetRow).values = [[parseFloat(salvageValue)]];\n      sheet.getRange(\"G\" + targetRow).numberFormat = [[\"#,##0.00\"]];\n      \n      return context.sync();\n    }).then(function() {\n      document.getElementById(\"assetName\").value = \"\";\n      document.getElementById(\"assetCost\").value = \"\";\n      showStatus(\"Asset '\" + assetName + \"' added!\", false);\n    });\n  }).catch(function(error) {\n    showStatus(\"Error: \" + error.message, true);\n    console.error(error);\n  });\n}\n\nfunction getColumnLetter(index) {\n  var letter = \"\";\n  index = index + 1;\n  while (index > 0) {\n    var remainder = (index - 1) % 26;\n    letter = String.fromCharCode(65 + remainder) + letter;\n    index = Math.floor((index - 1) / 26);\n  }\n  return letter;\n}\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.js\", import.meta.url);\n// Module\nvar code = \"<!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Capex & D&A Calculator</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js\\\"><\" + \"/script> <style>body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;margin:0;padding:20px;background-color:#f5f5f5}.header{text-align:center;margin-bottom:25px}.header h1{color:#217346;font-size:20px;margin:0 0 5px 0}.header p{color:#666;font-size:12px;margin:0}.section{background:#fff;border-radius:8px;padding:15px;margin-bottom:15px;box-shadow:0 1px 3px rgba(0,0,0,.1)}.section h2{font-size:14px;color:#333;margin:0 0 12px 0;padding-bottom:8px;border-bottom:1px solid #eee}.form-group{margin-bottom:12px}.form-group label{display:block;font-size:12px;color:#555;margin-bottom:4px}.form-group input{width:100%;padding:8px;border:1px solid #ddd;border-radius:4px;font-size:13px;box-sizing:border-box}.form-group input:focus{outline:0;border-color:#217346}.btn{width:100%;padding:12px;border:none;border-radius:6px;font-size:14px;font-weight:600;cursor:pointer;margin-bottom:10px;transition:background-color .2s}.btn-primary{background-color:#217346;color:#fff}.btn-primary:hover{background-color:#1a5c38}.btn-secondary{background-color:#0078d4;color:#fff}.btn-secondary:hover{background-color:#006cbe}.status{padding:10px;border-radius:4px;font-size:12px;margin-top:10px;display:none}.status.success{background-color:#d4edda;color:#155724;display:block}.status.error{background-color:#f8d7da;color:#721c24;display:block}</style> </head> <body> <div class=\\\"header\\\"> <h1>ðŸ“Š Capex & D&A Calculator</h1> <p>Create depreciation schedules instantly</p> </div> <div class=\\\"section\\\"> <h2>1. Create Template</h2> <div class=\\\"form-group\\\"> <label for=\\\"startDate\\\">Start Date</label> <input type=\\\"date\\\" id=\\\"startDate\\\" value=\\\"2026-01-01\\\"/> </div> <div class=\\\"form-group\\\"> <label for=\\\"numPeriods\\\">Number of Periods (months)</label> <input type=\\\"number\\\" id=\\\"numPeriods\\\" value=\\\"36\\\" min=\\\"1\\\" max=\\\"120\\\"/> </div> <button class=\\\"btn btn-primary\\\" id=\\\"createTemplate\\\">Create D&A Template</button> </div> <div class=\\\"section\\\"> <h2>2. Add New Asset</h2> <div class=\\\"form-group\\\"> <label for=\\\"assetName\\\">Asset Name</label> <input type=\\\"text\\\" id=\\\"assetName\\\" placeholder=\\\"e.g., MacBook Pro\\\"/> </div> <div class=\\\"form-group\\\"> <label for=\\\"assetDate\\\">Purchase Date</label> <input type=\\\"date\\\" id=\\\"assetDate\\\" value=\\\"2026-01-01\\\"/> </div> <div class=\\\"form-group\\\"> <label for=\\\"assetCost\\\">Cost</label> <input type=\\\"number\\\" id=\\\"assetCost\\\" placeholder=\\\"e.g., 12000\\\"/> </div> <div class=\\\"form-group\\\"> <label for=\\\"usefulLife\\\">Useful Life (months)</label> <input type=\\\"number\\\" id=\\\"usefulLife\\\" value=\\\"36\\\" min=\\\"1\\\"/> </div> <div class=\\\"form-group\\\"> <label for=\\\"salvageValue\\\">Salvage Value</label> <input type=\\\"number\\\" id=\\\"salvageValue\\\" placeholder=\\\"e.g., 1000\\\" value=\\\"0\\\"/> </div> <button class=\\\"btn btn-secondary\\\" id=\\\"addAsset\\\">Add Asset</button> </div> <div class=\\\"status\\\" id=\\\"status\\\"></div> <\" + \"script src=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\"><\" + \"/script> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","showStatus","message","isError","status","getElementById","textContent","className","setTimeout","createTemplate","Excel","run","context","startDateInput","value","numPeriods","parseInt","sheets","workbook","worksheets","load","sync","then","items","name","delete","sheet","add","lastCol","getColumnLetter","getRange","values","format","font","bold","size","color","numberFormat","col","prevCol","formulas","horizontalAlignment","fill","headers","row","formula","autofitColumns","columnWidth","freezePanes","freezeRows","freezeColumns","borders","getItem","style","activate","catch","error","console","addAsset","assetName","assetDate","assetCost","usefulLife","salvageValue","searchRange","targetRow","parseFloat","index","letter","remainder","String","fromCharCode","Math","floor","Office","onReady","info","host","HostType","onclick","URL"],"sourceRoot":""}